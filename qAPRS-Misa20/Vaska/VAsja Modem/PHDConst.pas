unit PHDConst;

interface

uses  windows, graphics, SysUtils, IniFiles;

const MaxDataSize   = 48000 * 30; //30sec

const WM_USER         = $0400;
      HILBPFIR_LENGTH = 58;

const Buffers         = 4;
      Channels        = 1;
      SR48            = 48000;
      AudioDataSize   = {SmallInt} 4096;
      vBmpWidth       = 180;
      vBmpHeight      = 180;
      vBmpTop         = 2;
      vBmpLeft        = 2;
      sBmpWidth       = 600;
      sBmpHeight      = 90;
      sBmpTop         = 184;
      sBmpLeft        = 2;
      Scope4xBmp      = 100;
      HeightAllConst  = Scope4xBmp * 4 + 65;

type
     ByteArray = array of Byte;
     DoubleArray = array [0..4096] of double;

     lpDataBuffers = array [0..AudioDataSize * 2] of Byte;
     lpDataArray = array [0..AudioDataSize * 2] of Byte;
     PmemBlock = ^lpDataArray;

const    
   aSin: array[0..359] of Double =
      (0, 0.0174524064372835, 0.034899496702501, 0.0523359562429438, 0.0697564737441253,
      0.0871557427476582, 0.104528463267653, 0.121869343405147, 0.139173100960065, 0.156434465040231,
      0.17364817766693, 0.190808995376545, 0.207911690817759, 0.224951054343865, 0.241921895599668,
      0.258819045102521, 0.275637355816999, 0.292371704722737, 0.309016994374947, 0.325568154457157,
      0.342020143325669, 0.3583679495453, 0.374606593415912, 0.390731128489274, 0.4067366430758,
      0.422618261740699, 0.438371146789077, 0.453990499739547, 0.469471562785891, 0.484809620246337,
      0.5, 0.515038074910054, 0.529919264233205, 0.544639035015027, 0.559192903470747,
      0.573576436351046, 0.587785252292473, 0.601815023152048, 0.615661475325658, 0.629320391049837,
      0.642787609686539, 0.656059028990507, 0.669130606358858, 0.681998360062499, 0.694658370458997,
      0.707106781186548, 0.719339800338651, 0.73135370161917, 0.743144825477394, 0.754709580222772,
      0.766044443118978, 0.777145961456971, 0.788010753606722, 0.798635510047293, 0.809016994374947,
      0.819152044288992, 0.829037572555042, 0.838670567945424, 0.848048096156426, 0.857167300702112,
      0.866025403784439, 0.874619707139396, 0.882947592858927, 0.891006524188368, 0.898794046299167,
      0.90630778703665, 0.913545457642601, 0.92050485345244, 0.927183854566787, 0.933580426497202,
      0.939692620785908, 0.945518575599317, 0.951056516295154, 0.956304755963035, 0.961261695938319,
      0.965925826289068, 0.970295726275996, 0.974370064785235, 0.978147600733806, 0.981627183447664,
      0.984807753012208, 0.987688340595138, 0.99026806874157, 0.992546151641322, 0.994521895368273,
      0.996194698091746, 0.997564050259824, 0.998629534754574, 0.999390827019096, 0.999847695156391,
      1, 0.999847695156391, 0.999390827019096, 0.998629534754574, 0.997564050259824,
      0.996194698091746, 0.994521895368273, 0.992546151641322, 0.99026806874157, 0.987688340595138,
      0.984807753012208, 0.981627183447664, 0.978147600733806, 0.974370064785235, 0.970295726275996,
      0.965925826289068, 0.961261695938319, 0.956304755963035, 0.951056516295154, 0.945518575599317,
      0.939692620785908, 0.933580426497202, 0.927183854566787, 0.92050485345244, 0.913545457642601,
      0.90630778703665, 0.898794046299167, 0.891006524188368, 0.882947592858927, 0.874619707139396,
      0.866025403784439, 0.857167300702112, 0.848048096156426, 0.838670567945424, 0.829037572555042,
      0.819152044288992, 0.809016994374947, 0.798635510047293, 0.788010753606722, 0.777145961456971,
      0.766044443118978, 0.754709580222772, 0.743144825477394, 0.73135370161917, 0.719339800338651,
      0.707106781186548, 0.694658370458997, 0.681998360062499, 0.669130606358858, 0.656059028990507,
      0.642787609686539, 0.629320391049837, 0.615661475325658, 0.601815023152048, 0.587785252292473,
      0.573576436351046, 0.559192903470747, 0.544639035015027, 0.529919264233205, 0.515038074910054,
      0.5, 0.484809620246337, 0.469471562785891, 0.453990499739547, 0.438371146789077,
      0.422618261740699, 0.4067366430758, 0.390731128489274, 0.374606593415912, 0.3583679495453,
      0.342020143325669, 0.325568154457157, 0.309016994374947, 0.292371704722737, 0.275637355816999,
      0.258819045102521, 0.241921895599668, 0.224951054343865, 0.207911690817759, 0.190808995376545,
      0.17364817766693, 0.156434465040231, 0.139173100960065, 0.121869343405147, 0.104528463267653,
      0.0871557427476582, 0.0697564737441253, 0.0523359562429438, 0.034899496702501, 0.0174524064372835,
      -5.42101086242752E-20, -0.0174524064372835, -0.034899496702501, -0.0523359562429438, -0.0697564737441253,
      -0.0871557427476582, -0.104528463267653, -0.121869343405147, -0.139173100960065, -0.156434465040231,
      -0.17364817766693, -0.190808995376545, -0.207911690817759, -0.224951054343865, -0.241921895599668,
      -0.258819045102521, -0.275637355816999, -0.292371704722737, -0.309016994374947, -0.325568154457157, 
      -0.342020143325669, -0.3583679495453, -0.374606593415912, -0.390731128489274, -0.4067366430758,
      -0.422618261740699, -0.438371146789077, -0.453990499739547, -0.469471562785891, -0.484809620246337,
      -0.5, -0.515038074910054, -0.529919264233205, -0.544639035015027, -0.559192903470747,
      -0.573576436351046, -0.587785252292473, -0.601815023152048, -0.615661475325658, -0.629320391049837, 
      -0.642787609686539, -0.656059028990507, -0.669130606358858, -0.681998360062499, -0.694658370458997,
      -0.707106781186548, -0.719339800338651, -0.73135370161917, -0.743144825477394, -0.754709580222772,
      -0.766044443118978, -0.777145961456971, -0.788010753606722, -0.798635510047293, -0.809016994374947, 
      -0.819152044288992, -0.829037572555042, -0.838670567945424, -0.848048096156426, -0.857167300702112,
      -0.866025403784439, -0.874619707139396, -0.882947592858927, -0.891006524188368, -0.898794046299167,
      -0.90630778703665, -0.913545457642601, -0.92050485345244, -0.927183854566787, -0.933580426497202, 
      -0.939692620785908, -0.945518575599317, -0.951056516295154, -0.956304755963035, -0.961261695938319,
      -0.965925826289068, -0.970295726275996, -0.974370064785235, -0.978147600733806, -0.981627183447664,
      -0.984807753012208, -0.987688340595138, -0.99026806874157, -0.992546151641322, -0.994521895368273, 
      -0.996194698091746, -0.997564050259824, -0.998629534754574, -0.999390827019096, -0.999847695156391,
      -1, -0.999847695156391, -0.999390827019096, -0.998629534754574, -0.997564050259824,
      -0.996194698091746, -0.994521895368273, -0.992546151641322, -0.99026806874157, -0.987688340595138, 
      -0.984807753012208, -0.981627183447664, -0.978147600733806, -0.974370064785235, -0.970295726275996,
      -0.965925826289068, -0.961261695938319, -0.956304755963035, -0.951056516295154, -0.945518575599317,
      -0.939692620785908, -0.933580426497202, -0.927183854566787, -0.92050485345244, -0.913545457642601, 
      -0.90630778703665, -0.898794046299167, -0.891006524188368, -0.882947592858927, -0.874619707139396,
      -0.866025403784439, -0.857167300702112, -0.848048096156426, -0.838670567945424, -0.829037572555042,
      -0.819152044288992, -0.809016994374947, -0.798635510047293, -0.788010753606722, -0.777145961456971, 
      -0.766044443118978, -0.754709580222772, -0.743144825477394, -0.73135370161917, -0.719339800338651,
      -0.707106781186548, -0.694658370458997, -0.681998360062499, -0.669130606358858, -0.656059028990507,
      -0.642787609686539, -0.629320391049837, -0.615661475325658, -0.601815023152048, -0.587785252292473, 
      -0.573576436351046, -0.559192903470747, -0.544639035015027, -0.529919264233205, -0.515038074910054,
      -0.5, -0.484809620246337, -0.469471562785891, -0.453990499739547, -0.438371146789077,
      -0.422618261740699, -0.4067366430758, -0.390731128489274, -0.374606593415912, -0.3583679495453, 
      -0.342020143325669, -0.325568154457157, -0.309016994374947, -0.292371704722737, -0.275637355816999,
      -0.258819045102521, -0.241921895599668, -0.224951054343865, -0.207911690817759, -0.190808995376545,
      -0.17364817766693, -0.156434465040231, -0.139173100960065, -0.121869343405147, -0.104528463267653, 
      -0.0871557427476582, -0.0697564737441253, -0.0523359562429438, -0.034899496702501, -0.0174524064372835);

   aCos: array[0..359] of Double =
      (1, 0.999847695156391, 0.999390827019096, 0.998629534754574, 0.997564050259824,
      0.996194698091746, 0.994521895368273, 0.992546151641322, 0.99026806874157, 0.987688340595138,
      0.984807753012208, 0.981627183447664, 0.978147600733806, 0.974370064785235, 0.970295726275996,
      0.965925826289068, 0.961261695938319, 0.956304755963035, 0.951056516295154, 0.945518575599317,
      0.939692620785908, 0.933580426497202, 0.927183854566787, 0.92050485345244, 0.913545457642601,
      0.90630778703665, 0.898794046299167, 0.891006524188368, 0.882947592858927, 0.874619707139396,
      0.866025403784439, 0.857167300702112, 0.848048096156426, 0.838670567945424, 0.829037572555042,
      0.819152044288992, 0.809016994374947, 0.798635510047293, 0.788010753606722, 0.777145961456971,
      0.766044443118978, 0.754709580222772, 0.743144825477394, 0.73135370161917, 0.719339800338651,
      0.707106781186548, 0.694658370458997, 0.681998360062499, 0.669130606358858, 0.656059028990507,
      0.642787609686539, 0.629320391049837, 0.615661475325658, 0.601815023152048, 0.587785252292473,
      0.573576436351046, 0.559192903470747, 0.544639035015027, 0.529919264233205, 0.515038074910054,
      0.5, 0.484809620246337, 0.469471562785891, 0.453990499739547, 0.438371146789077,
      0.422618261740699, 0.4067366430758, 0.390731128489274, 0.374606593415912, 0.3583679495453,
      0.342020143325669, 0.325568154457157, 0.309016994374947, 0.292371704722737, 0.275637355816999,
      0.258819045102521, 0.241921895599668, 0.224951054343865, 0.207911690817759, 0.190808995376545,
      0.17364817766693, 0.156434465040231, 0.139173100960065, 0.121869343405147, 0.104528463267653,
      0.0871557427476582, 0.0697564737441253, 0.0523359562429438, 0.034899496702501, 0.0174524064372835, 
      0, -0.0174524064372835, -0.034899496702501, -0.0523359562429438, -0.0697564737441253,
      -0.0871557427476582, -0.104528463267653, -0.121869343405147, -0.139173100960065, -0.156434465040231,
      -0.17364817766693, -0.190808995376545, -0.207911690817759, -0.224951054343865, -0.241921895599668,
      -0.258819045102521, -0.275637355816999, -0.292371704722737, -0.309016994374947, -0.325568154457157,
      -0.342020143325669, -0.3583679495453, -0.374606593415912, -0.390731128489274, -0.4067366430758,
      -0.422618261740699, -0.438371146789077, -0.453990499739547, -0.469471562785891, -0.484809620246337, 
      -0.5, -0.515038074910054, -0.529919264233205, -0.544639035015027, -0.559192903470747,
      -0.573576436351046, -0.587785252292473, -0.601815023152048, -0.615661475325658, -0.629320391049837,
      -0.642787609686539, -0.656059028990507, -0.669130606358858, -0.681998360062499, -0.694658370458997,
      -0.707106781186548, -0.719339800338651, -0.73135370161917, -0.743144825477394, -0.754709580222772,
      -0.766044443118978, -0.777145961456971, -0.788010753606722, -0.798635510047293, -0.809016994374947,
      -0.819152044288992, -0.829037572555042, -0.838670567945424, -0.848048096156426, -0.857167300702112, 
      -0.866025403784439, -0.874619707139396, -0.882947592858927, -0.891006524188368, -0.898794046299167,
      -0.90630778703665, -0.913545457642601, -0.92050485345244, -0.927183854566787, -0.933580426497202,
      -0.939692620785908, -0.945518575599317, -0.951056516295154, -0.956304755963035, -0.961261695938319,
      -0.965925826289068, -0.970295726275996, -0.974370064785235, -0.978147600733806, -0.981627183447664,
      -0.984807753012208, -0.987688340595138, -0.99026806874157, -0.992546151641322, -0.994521895368273,
      -0.996194698091746, -0.997564050259824, -0.998629534754574, -0.999390827019096, -0.999847695156391, 
      -1, -0.999847695156391, -0.999390827019096, -0.998629534754574, -0.997564050259824,
      -0.996194698091746, -0.994521895368273, -0.992546151641322, -0.99026806874157, -0.987688340595138,
      -0.984807753012208, -0.981627183447664, -0.978147600733806, -0.974370064785235, -0.970295726275996,
      -0.965925826289068, -0.961261695938319, -0.956304755963035, -0.951056516295154, -0.945518575599317,
      -0.939692620785908, -0.933580426497202, -0.927183854566787, -0.92050485345244, -0.913545457642601,
      -0.90630778703665, -0.898794046299167, -0.891006524188368, -0.882947592858927, -0.874619707139396, 
      -0.866025403784439, -0.857167300702112, -0.848048096156426, -0.838670567945424, -0.829037572555042,
      -0.819152044288992, -0.809016994374947, -0.798635510047293, -0.788010753606722, -0.777145961456971,
      -0.766044443118978, -0.754709580222772, -0.743144825477394, -0.73135370161917, -0.719339800338651,
      -0.707106781186548, -0.694658370458997, -0.681998360062499, -0.669130606358858, -0.656059028990507,
      -0.642787609686539, -0.629320391049837, -0.615661475325658, -0.601815023152048, -0.587785252292473,
      -0.573576436351046, -0.559192903470747, -0.544639035015027, -0.529919264233205, -0.515038074910054, 
      -0.5, -0.484809620246337, -0.469471562785891, -0.453990499739547, -0.438371146789077,
      -0.422618261740699, -0.4067366430758, -0.390731128489274, -0.374606593415912, -0.3583679495453,
      -0.342020143325669, -0.325568154457157, -0.309016994374947, -0.292371704722737, -0.275637355816999,
      -0.258819045102521, -0.241921895599668, -0.224951054343865, -0.207911690817759, -0.190808995376545,
      -0.17364817766693, -0.156434465040231, -0.139173100960065, -0.121869343405147, -0.104528463267653,
      -0.0871557427476582, -0.0697564737441253, -0.0523359562429438, -0.034899496702501, -0.0174524064372835, 
      0, 0.0174524064372835, 0.034899496702501, 0.0523359562429438, 0.0697564737441253,
      0.0871557427476582, 0.104528463267653, 0.121869343405147, 0.139173100960065, 0.156434465040231,
      0.17364817766693, 0.190808995376545, 0.207911690817759, 0.224951054343865, 0.241921895599668,
      0.258819045102521, 0.275637355816999, 0.292371704722737, 0.309016994374947, 0.325568154457157,
      0.342020143325669, 0.3583679495453, 0.374606593415912, 0.390731128489274, 0.4067366430758,
      0.422618261740699, 0.438371146789077, 0.453990499739547, 0.469471562785891, 0.484809620246337, 
      0.5, 0.515038074910054, 0.529919264233205, 0.544639035015027, 0.559192903470747,
      0.573576436351046, 0.587785252292473, 0.601815023152048, 0.615661475325658, 0.629320391049837,
      0.642787609686539, 0.656059028990507, 0.669130606358858, 0.681998360062499, 0.694658370458997,
      0.707106781186548, 0.719339800338651, 0.73135370161917, 0.743144825477394, 0.754709580222772,
      0.766044443118978, 0.777145961456971, 0.788010753606722, 0.798635510047293, 0.809016994374947,
      0.819152044288992, 0.829037572555042, 0.838670567945424, 0.848048096156426, 0.857167300702112, 
      0.866025403784439, 0.874619707139396, 0.882947592858927, 0.891006524188368, 0.898794046299167,
      0.90630778703665, 0.913545457642601, 0.92050485345244, 0.927183854566787, 0.933580426497202,
      0.939692620785908, 0.945518575599317, 0.951056516295154, 0.956304755963035, 0.961261695938319,
      0.965925826289068, 0.970295726275996, 0.974370064785235, 0.978147600733806, 0.981627183447664,
      0.984807753012208, 0.987688340595138, 0.99026806874157, 0.992546151641322, 0.994521895368273,
      0.996194698091746, 0.997564050259824, 0.998629534754574, 0.999390827019096, 0.999847695156391);


IHilbertBPFirCoef: array[0..HILBPFIR_LENGTH] of Double =

( 0.0015461946, 0.00096844503, 0.003185104, -0.00045313707, 0.0040178359, -0.0010694961, 0.0046038332, -0.0012170725,
 0.0022920463, -3.5363822e-017, -0.0033438091, 0.0022776352, -0.012046394, 0.0039531812, -0.021553635, 0.00201261,
 -0.028298385, -0.0070138471, -0.02851387, -0.025490301, -0.019959804, -0.053128174, -0.0032769397, -0.086207816,
 0.017691961, -0.11813811, 0.036951781, -0.14135815, 0.048464111, 0.85015276, 0.048464111, -0.14135815, 0.036951781,
 -0.11813811, 0.017691961, -0.086207816, -0.0032769397, -0.053128174, -0.019959804, -0.025490301, -0.02851387,
 -0.0070138471, -0.028298385, 0.00201261, -0.021553635, 0.0039531812, -0.012046394, 0.0022776352, -0.0033438091,
 -3.5363822e-017, 0.0022920463, -0.0012170725, 0.0046038332, -0.0010694961, 0.0040178359, -0.00045313707, 0.003185104,
 0.00096844503, 0.0015461946);

QHilbertBPFirCoef: array[0..HILBPFIR_LENGTH] of Double =

( 0.0013205749, -0.0013329502, 0.0019518342, 0.00088933157, 0.0016642421, 0.0032915705, 0.0011052826, 0.0076842931,
 0.00018038796, 0.012029604, 0.00026316348, 0.014380423, 0.0028920833, 0.012166641, 0.0089278078, 0.0039499695,
 0.017341273, -0.0096537323, 0.024353146, -0.025490301, 0.023369928, -0.038599878, 0.0053474796, -0.043925076,
 -0.042712172, -0.038385399, -0.15391524, -0.022388932, -0.61579492,
 0,
 0.61579492, 0.022388932, 0.15391524,
 0.038385399, 0.042712172, 0.043925076, -0.0053474796, 0.038599878, -0.023369928, 0.025490301, -0.024353146,
 0.0096537323, -0.017341273, -0.0039499695, -0.0089278078, -0.012166641, -0.0028920833, -0.014380423, -0.00026316348,
 -0.012029604, -0.00018038796, -0.0076842931, -0.0011052826, -0.0032915705, -0.0016642421, -0.00088933157,
 -0.0019518342, 0.0013329502, -0.0013205749);

aHilCoef: array[0..34] of Double =

(-5.43246000084358E-03, 3.42854809248329E-05, -9.14574264388444E-03, 6.89392718555355E-05, -1.64304048268173E-02,
 1.15764912195663E-04, -2.73050451038467E-02, 1.51654561466247E-04, -4.34211184289123E-02, 1.70436841508293E-04,
 -6.81392139008395E-02, 1.605410547708E-04, -0.110138307308294, 1.28660816138287E-04, -0.201520972310985,
 7.30126343916684E-05, -0.63299351073562,
 0,
 0.63299351073562, -7.30126343916684E-05, 0.201520972310985,
 -1.28660816138287E-04, 0.110138307308294, -1.605410547708E-04, 6.81392139008395E-02, -1.70436841508293E-04,
 4.34211184289123E-02, -1.51654561466247E-04, 2.73050451038467E-02, -1.15764912195663E-04, 1.64304048268173E-02,
 -6.89392718555355E-05, 9.14574264388444E-03, -3.42854809248329E-05, 5.43246000084358E-03 );


type  RMapRec = record
      Xc, Xs: single;
      Cod: Byte;
      end;

      Complex = record
      Re, Im : double;
      end;

const
  aMapPSK2: array[1..2] of RMapRec =
            ((Xc: 100; Xs: 0; Cod: 0),(Xc: -100; Xs: 0; Cod: 1));

var
   FIniFile          :  TIniFile;
   aaSSet            :  array[1..4] of array[0..12] of Boolean;
   PSKCounter        :  Longint;
   BadData           :  Int64;
   RXPerception      :  Longint;
   WindowingArr      :  array of double;
   CanDrawVector     :  Boolean;
   vBitmap           :  TBitmap;
   Language          :  Byte;
   ReceivedData      :  String;

procedure InitWindowing(wSize: word);
procedure DoubleToRGB(Account:  Double; var R,G,B:  BYTE);
procedure DoubleToRGBlue(Account:  Double; var R,G,B:  BYTE);
function  LocalDateNow: String;

implementation

function LocalDateNow: String;
var Present: TDateTime;
    Year, Month, Day, Hour, Min, Sec, MSec: Word;
begin
     Present:= Now;
     DecodeDate(Present, Year, Month, Day);
     DecodeTime(Present, Hour, Min, Sec, MSec);
     Result:= Format('%.2d.%.2d.%.4d', [Day, Month, Year])+
     ' ' + Format('%.2d:%.2d:%.2d', [Hour, Min, Sec]);
end;

procedure InitWindowing(wSize: word);
var i : integer;
begin
     SetLength(WindowingArr, wSize);
     for i := 0 to wSize - 1 do
     begin
          //t := i/(wSize - 1) - 0.5;
          //WindowingArr[i] := 1;                           {Равномерное}
          //WindowingArr[i] := 1 - 2*Abs(t);                {Барлетта}
          //WindowingArr[i] := 0.5+0.5*Cos(2*Pi*t);         {Ханна}
          //WindowingArr[i] := 0.54+0.46*Cos(2*Pi*t);       {Хэмминга}
          //WindowingArr[i] := 0.3635819+0.4891775*Cos(2*Pi*t)+0.1365995*Cos(4*Pi*t)+0.0106411*Cos(6*Pi*t); {Натолла}
          // WindowingArr[i] := 0.35875 - 0.48829*cos(2*pi*i/wSize) + 0.14128*cos(4*pi*i/wSize) - 0.01168*cos(6*pi*i/wSize);//Блэкмана-Харриса
          WindowingArr[i] := 0.42 - 0.5*cos(2*pi*i/wSize) + 0.08*cos(4*pi*i/wSize); //Блэкмана
     end;
end;

procedure DoubleToRGB(Account:  double;
                            var R,G,B:  Byte);
   var
     Blue  :  double;
     factor:  double;
     Green :  double;
     Red   :  double;

   FUNCTION Adjust(Color, Factor:  double):  Integer;
   begin
     if   Color = 0.0
     then Result := 0
     else Result := round(255 * (Color * Factor))
   end;

 begin

   case TRUNC(Account) of
     0..8000-1:
       begin
         Red   := -(Account - 8000) / 8000;
         Green := 0.0;
         Blue  := 1.0
       end;

     8000..14000-1:
       begin
         Red   := 0.0;
         Green := (Account - 8000) / (14000 - 8000);
         Blue  := 1.0
       end;

     14000..20000-1:
       begin
         Red   := 0.0;
         Green := 1.0;
         Blue  := -(Account - 20000) / (20000 - 14000)
       end;

     20000..24000-1:
       begin
         Red   := (Account - 20000) / (24000 - 20000);
         Green := 1.0;
         Blue  := 0.0
       end;

     24000..32000-1:
       begin
         Red   := 1.0;
         Green := -(Account - 32000) / (32000 - 24000);
         Blue  := 0.0
       end;

     32000..32767:
       begin
         Red   := 1.0;
         Green := 0.0;
         Blue  := 0.0
       end;

     else
       Red   := 0.0;
       Green := 0.0;
       Blue  := 0.0
   end;

   factor := 0.0;
   if (Account >= 0) and (Account < 12000) then factor := 0.1 + 0.7* Account  / (12000-1);
   if (Account >= 12000) and (Account <= 32767) then factor := 1.0;

   R := Adjust(Red,   Factor);
   G := Adjust(Green, Factor);
   B := Adjust(Blue,  Factor)
 end;

procedure DoubleToRGBlue(Account:  Double; var R,G,B:  BYTE);
begin
     if (Account >= 0) and (Account < 256) then
     begin
         R := 0;
         G := 0;
         B := Round(Account);
     end;
     if (Account >= 256) and (Account < 510) then
     begin
         R := Round(Account-255);
         G := Round(Account-255);
         B := 255;
     end;
     if (Account >= 510) then
     begin
         R := 255;
         G := 255;
         B := 255;
     end;
end;

end.
